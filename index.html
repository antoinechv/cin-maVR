<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Forest Gump</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
</head>
<body>
<a-scene physics="debug: false" fog="type: exponential; color: white; density: 0.2">
    <a-assets>
        <a-asset-item id="Bench" src="./models/Bench.glb"></a-asset-item>
        <a-asset-item id="Valise" src="./models/valise.glb"></a-asset-item>
        <a-asset-item id="box" src="./models/chocolate.glb"></a-asset-item>
        <img id="poster" src="./images/affiche.jpeg" alt="Forest Gump Poster">
        <audio id="background-music" src="./audio/theme.mp3" preload="auto"></audio>
    </a-assets>

    <!-- Lumières -->
    <a-light type="ambient" color="#ffffff" intensity="0.5"></a-light>

    <!-- Caméra avec corps dynamique pour collision -->
    <a-entity id="rig" position="0 1 7" dynamic-body>
        <a-camera id="camera" camera="look-controls: false;">
            <a-cursor position="0 0 -1"
                      material="color: white; shader: flat;">
            </a-cursor>
        </a-camera>
    </a-entity>

    <!-- Boîte noire autour de l'affiche -->
    <a-box id="poster-room" position="0 1.5 3" depth="8" height="4" width="4"
           material="color: #000; side: double;" static-body>
        <a-entity position="0 0.8 -3.94">
            <a-box position="0 -0.6 0" width="2.3" height="3.3" depth="0.1"
                   material="color: black; emissive: #fff; emissive-intensity: 0.2;">
                <a-plane position="0 0 0.06" width="2" height="3" material="src: #poster; side: double;"
                         class="enter-button">
                </a-plane>
            </a-box>
        </a-entity>

        <!-- Spots lumineux au plafond -->
        <a-light type="point" position="-2 3 0" intensity="1" color="#ffffff" castShadow="true"></a-light>
        <a-light type="point" position="2 3 0" intensity="1" color="#ffffff" castShadow="true"></a-light>
        <a-light type="point" position="0 3 -2" intensity="0.7" color="#ffffff" castShadow="true"></a-light>
        <a-light type="point" position="0 3 2" intensity="0.7" color="#ffffff" castShadow="true"></a-light>
    </a-box>


    <!-- Scène principale (cachée au début) -->
    <a-entity id="main-scene" visible="false">
        <!-- Banc -->
        <a-entity gltf-model="#Bench" position="0.8 1 -0.8" scale="0.2 0.1 0.1"></a-entity>
        <!-- Valise -->
        <a-entity gltf-model="#Valise" position="0.8 0.3 -0.6" rotation="0 120 0" scale="0.15 0.15 0.15"></a-entity>
        <!-- Boîte de chocolat -->
        <a-entity gltf-model="#box" position="1.4 1.05 -0.6" rotation="0 30 0" scale="0.15 0.15 0.15"></a-entity>
        <!-- Son de fond -->
        <a-entity id="background-sound"
                  sound="src: #background-music; autoplay: false; loop: true; volume: 0.5"></a-entity>
    </a-entity>
</a-scene>


<script>
    // Script pour gérer la transition entre l'affiche et la scène principale
    document.querySelector('.enter-button').addEventListener('click', () => {
        // Masquer la boîte noire
        const posterRoom = document.querySelector('#poster-room');
        posterRoom.setAttribute('visible', 'false');

        // Rendre visible la scène principale
        const mainScene = document.querySelector('#main-scene');
        mainScene.setAttribute('visible', 'true');

        // Activer les contrôles de la caméra
        const camera = document.querySelector('#camera');
        camera.setAttribute('look-controls', 'enabled: true');
        camera.setAttribute('wasd-controls', 'enabled: true');

        // Lancer la musique
        const backgroundSound = document.querySelector('#background-sound');
        backgroundSound.components.sound.playSound();
    });
</script>
</body>
</html>
